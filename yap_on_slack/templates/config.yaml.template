# yaml-language-server: $schema=https://raw.githubusercontent.com/echohello-dev/yap-on-slack/main/schema/config.schema.json
# Yap on Slack Configuration
# Save as: ~/.config/yap-on-slack/config.yaml (default) or ./config.yaml (local override)

# Workspace settings (required)
workspace:
  org_url: https://your-workspace.slack.com  # Your Slack workspace URL
  channel_id: C0123456789                    # Target channel ID (find in channel details)
  team_id: T0123456789                       # Workspace team ID (find in workspace settings)

# Default credentials (required if not using users array)
# Extract tokens from browser dev tools while logged into Slack
credentials:
  xoxc_token: xoxc-your-token-here  # Session token (starts with xoxc-)
  xoxd_token: xoxd-your-token-here  # Session cookie (starts with xoxd-)
  cookies: ""                        # Optional: extra cookies (semi-colon separated)

# SSL/TLS settings (optional)
# Useful for corporate proxies or self-signed certificates
# Note: Automatically respects standard environment variables:
#   SSL_CERT_FILE, REQUESTS_CA_BUNDLE, CURL_CA_BUNDLE (CA bundle file)
#   SSL_CERT_DIR (CA certificate directory)
#   SSL_STRICT_X509 (enable/disable strict X509 verification: true/false or 1/0)
# ssl:
#   verify: true                     # Enable SSL verification (default: true)
#   ca_bundle: ~/your-corporate-cert.pem         # Path to custom CA bundle (for corporate proxies)
#   no_strict: false                 # Disable strict X509 (Python 3.13+ compat, default: false)
#   strict_x509: null                # Force strict X509 mode (null=auto, true=enable, false=disable)
#                                    # Auto mode: disables strict for custom CA bundles (recommended)
# CLI overrides: --no-verify-ssl, --ssl-ca-bundle <path>, --ssl-no-strict, --ssl-strict
# Env vars: SSL_VERIFY=false, SSL_CA_BUNDLE=~/cert.pem, SSL_NO_STRICT=true, SSL_STRICT_X509=true

# User selection strategy for multi-user posting
user_strategy: round_robin  # Options: round_robin | random

# Additional users (optional, merged with default credentials user)
# Uncomment to enable multi-user posting:
# users:
#   - name: alice
#     xoxc_token: xoxc-alice-token
#     xoxd_token: xoxd-alice-token
#   - name: bob
#     xoxc_token: xoxc-bob-token
#     xoxd_token: xoxd-bob-token

# Messages to post (optional, can also use --use-ai to generate)
# Uncomment to define custom messages:
# messages:
#   - text: "Good morning team! :wave:"
#     user: alice  # Optional: specify which user posts this message
#     replies:
#       - "Hey! Ready for standup?"
#       - text: "Morning everyone"
#         user: bob  # Optional: specify user for this reply
#     reactions:
#       - wave
#       - coffee
#
#   - text: "*Important*: Deploy scheduled for 2pm PST :rocket:"
#     replies:
#       - "Thanks for the heads up!"
#     reactions:
#       - rocket
#       - eyes

# AI message generation settings
ai:
  enabled: false                              # Set to true to enable AI generation
  model: openrouter/auto                      # Auto-selects best model (recommended)
  # See top weekly models: https://openrouter.ai/models?order=top-weekly
  api_key: ""                                 # Or use OPENROUTER_API_KEY env var
  temperature: 0.7                            # Model temperature (0.0-1.0)
  max_tokens: 4000                            # Max tokens for generation
  # system_prompt: |                          # Optional: custom prompt (overrides default)
  #   Generate realistic Slack messages for testing...
  # Default system prompt: https://github.com/echohello-dev/yap-on-slack/blob/main/yap_on_slack/prompts/generate_messages.txt

  # GitHub context integration (optional)
  github:
    enabled: true                             # Enable GitHub context fetching
    token: ""                                 # Optional: explicit token (or use GITHUB_TOKEN env var)
    limit: 5                                  # Max repos to fetch (1-20)
    
    # Per-category item limits
    items_per_repo:
      commits: 5                              # Max commits per repo
      prs: 5                                  # Max PRs per repo
      issues: 5                               # Max issues per repo
    
    # Repository selection (optional)
    repos:
      mode: auto                              # Options: auto (recent), include (specific), exclude (blacklist)
      # include:                              # Specific repos (when mode=include)
      #   - echohello-dev/yap-on-slack
      #   - myorg/important-project
      # exclude:                              # Skip these repos (when mode=exclude)
      #   - myorg/archived-repo
    
    # Filtering options
    date_since: ""                            # Filter data since date (e.g., "7d", "30d", "2024-01-01")
    authors:                                  # Filter by authors (use "@me" for authenticated user)
      # - "@me"                               # Special: your GitHub username
      # - "dependabot[bot]"                   # Or specific usernames
    pr_state: all                             # Options: open, closed, all
    issue_state: all                          # Options: open, closed, all
    include_repo_metadata: true               # Include language, topics, stars, description

# Channel scanning settings (for `yos scan` command)
# scan:
#   limit: 200                                # Max messages to fetch (10-5000)
#   throttle: 0.5                             # Delay between API batches in seconds
#   output_dir: ~/.config/yap-on-slack/scan   # Where to save prompts and exports
#   model: openrouter/auto                    # Model for prompt generation
#   export_data: true                         # Export messages to text file

# Note: Environment variables take precedence over config file values:
# - SLACK_XOXC_TOKEN, SLACK_XOXD_TOKEN override credentials
# - SLACK_ORG_URL, SLACK_CHANNEL_ID, SLACK_TEAM_ID override workspace
# - OPENROUTER_API_KEY overrides ai.api_key
